联合体
===

联合和结构的区别在于：联合每次只能存储一个成员，联合体的长度由最宽成员类型决定。

```c
typedef struct {
    int type;
    union {
        int ivalue;
        long long lvalue;
    } value;
} data_t;
data_t d = { 0x8899, .value.lvalue = 0x1234LL };
data_t d2;
memcpy(&d2, &d, sizeof(d));
printf("type:%d, value:%lld\n", d2.type, d2.value.lvalue);
```

当然也可以用指针来实现上例功能，但 union 会将数据内嵌在结构体中，这对于进行 memcpy 等
操作更加方便快捷，且不需进行指针类型转换。

可以使用初始化器初始化联合，如果没有指定成员修饰符，则默认是第一个成员。

```c
union value_t
{
int ivalue;
long long lvalue;
};
union value_t v1 = { 10 };
printf("%d\n", v1.ivalue);
union value_t v2 = { .lvalue = 20LL };
printf("%lld\n", v2.lvalue);
union value2_t { char c; int x; } v3 = { .x = 100 };
printf("%d\n", v3.x);
```

一个常用的联合体用法。

```c
union { int x; struct {char a, b, c, d;} bytes; } n = { 0x12345678 };
printf("%#x => %x, %x, %x, %x\n", n.x, n.bytes.a, n.bytes.b, n.bytes.c, n.bytes.d);

// Result:
0x12345678 => 78, 56, 34, 12
```
